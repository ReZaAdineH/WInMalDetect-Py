import os
import sys
import hashlib
import shutil

def check_malware_paths():
    malware_paths = [
        r"C:\Windows",
        r"C:\Windows\System32",
        r"C:\Program Files",
        r"C:\Program Files (x86)",
        r"C:\ProgramData",
        r"C:\Users",
        r"C:\User\Public"
    ]

    for path in malware_paths:
        if os.path.exists(path):
            print(f"{path} exists.")
            files = os.listdir(path)
            for file in files:
                file_path = os.path.join(path, file)
                if os.path.isfile(file_path) and file.endswith(".exe"):
                    print(f"\t{file} is an executable file.")
                    hash = hashlib.md5(open(file_path, "rb").read()).hexdigest()
                    print(f"\t\tMD5 Hash: {hash}")
                    known_malware_hashes = [
                        "d41d8cd98f00b204e9800998ecf8427e",
                        "9e107d9d372bb6826bd81d3542a419d6",
                        "0cc175b9c0f1b6a831c399e269772661"
                    ]
                    if hash in known_malware_hashes:
                        print(f"\t\t\t{file} is known malware!")
                        backup_file = file_path + ".bak"
                        shutil.copy2(file_path, backup_file)
                        print(f"\t\t\t{file} has been backed up to {backup_file}.")
        else:
            print(f"{path} does not exist.")

if __name__ == "__main__":
    if sys.platform != "win32":
        print("This code is for Windows systems only.")
        sys.exit(1)
    check_malware_paths()
